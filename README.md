# BotTaxi

# Telegram Бот Междугородних Перевозок

Этот бот представляет собой платформу для связи пассажиров и водителей, осуществляющих междугородние поездки.

## Функционал

*   **Регистрация:** Пользователи (пассажиры и водители) регистрируются с указанием ФИО и номера телефона.
*   **Пассажиры:** Могут искать поездки по маршруту и дате, просматривать детали поездок и бронировать места. Могут просматривать и отменять свои бронирования.
*   **Водители:** Могут зарегистрироваться как водители, указав данные автомобиля. Могут создавать новые поездки (маршрут, время, количество мест), просматривать и отменять свои созданные поездки. Получают уведомления о новых бронированиях и отменах.
*   **Администраторы:** Могут назначать пользователей водителями, блокировать/разблокировать пользователей. Получают сообщения от пользователей через систему поддержки.
*   **Поддержка:** Любой зарегистрированный пользователь может отправить сообщение администратору.

## Структура Проекта

intercity_travel_bot/
│
├── venv/ # Виртуальное окружение Python
│
├── src/ # Основной исходный код бота
│ ├── bot.py # Главный файл запуска
│ ├── config.py # Конфигурация (токен, админы, БД)
│ ├── requirements.txt # Зависимости Python
│ │
│ ├── database/ # Модуль для работы с БД (SQLAlchemy)
│ │ ├── init.py
│ │ ├── models.py # Модели таблиц
│ │ ├── database.py # Настройка подключения, сессии
│ │ └── crud.py # Функции CRUD
│ │
│ ├── handlers/ # Обработчики Telegram (команды, сообщения, колбэки)
│ │ ├── init.py
│ │ ├── common.py # Общие (start, help, регистрация, cancel)
│ │ ├── admin.py # Админские команды
│ │ ├── driver.py # Команды водителя
│ │ ├── passenger.py # Команды пассажира
│ │ └── support.py # Система поддержки
│ │
│ ├── keyboards/ # Генерация клавиатур Telegram
│ │ ├── init.py
│ │ ├── inline.py # Inline-клавиатуры
│ │ └── reply.py # Reply-клавиатуры
│ │
│ └── utils/ # Вспомогательные утилиты
│ ├── init.py
│ └── helpers.py # Форматирование, парсинг и т.д.
│
├── .env.example # Пример файла переменных окружения
├── .gitignore # Игнорируемые файлы Git
└── README.md # Этот файл

## Инструкция по Установке

1.  **Клонировать репозиторий:**
    ```bash
    git clone <URL репозитория>
    cd intercity_travel_bot
    ```
    Или скачайте и распакуйте архив с кодом.

2.  **Установить Python:** Убедитесь, что у вас установлен Python 3.9 или выше.

3.  **Создать и активировать виртуальное окружение:**
    ```bash
    python -m venv venv
    # Linux / macOS
    source venv/bin/activate
    # Windows (cmd.exe)
    venv\Scripts\activate.bat
    # Windows (PowerShell)
    venv\Scripts\Activate.ps1
    ```

4.  **Установить зависимости:**
    ```bash
    pip install -r src/requirements.txt
    ```

5.  **Настроить конфигурацию:**
    *   Создайте файл `.env` в корне проекта, скопировав `.env.example`.
    *   Откройте `.env` и заполните его вашими данными:
        *   `BOT_TOKEN`: Токен вашего Telegram бота (получить у `@BotFather`).
        *   `ADMIN_IDS`: Ваш Telegram ID (и других админов через запятую, если нужно). Получить ID можно у ботов типа `@userinfobot`.
        *   `DATABASE_URL`: Строка подключения к базе данных. По умолчанию используется SQLite (`sqlite:///./travel_bot.db`), файл будет создан в корне проекта. Вы можете изменить на PostgreSQL или другую СУБД, поддерживаемую SQLAlchemy (не забудьте установить соответствующий драйвер в `requirements.txt`).

6.  **Инициализировать Базу Данных:**
    *   Запустите скрипт для создания таблиц (если используется SQLite или БД пустая):
        ```bash
        python src/database/database.py
        ```
    *   Или таблицы будут созданы автоматически при первом запуске `bot.py`, если `init_db()` вызывается там.

7.  **Запустить Бота:**
    ```bash
    python src/bot.py
    ```

8.  **Начать использование:** Найдите вашего бота в Telegram и отправьте команду `/start`.
